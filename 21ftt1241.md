# Assignment 1: VPS Deployment Logbook

### 1. Setting Up SSH Key
1. Create an SSH key using ED25519 encryption and include your student email as the end comment on windows terminal / cmd / powershell

	```
	ssh-keygen -t ed25519 -C “<21ftt1241@student.pb.edu.bn>”
	```
	>Create a '.ssh' directory if needed using 'mkdir'
	
	- An SSH key with the name sop_as1 and sop_as1.pub will be generated inside your specified directory
	- use the command `type sop_as1.pub` in order to get the content of the key
	- Copy the content of the key and save it for the next step
  
2. Ensure the following details when generating the SSH key
	- Name: sop_as1
	- Type: ED25519
	- Have your PB Email as the key comment

### 2. Create Droplet server
1. Head over to [Digital Ocean](https://www.digitalocean.com/) and create a droplet server
2. Ensure the following details are correct
	- HostName: sop-as1
	- Key: ==Copied key content from steps 1.2==
	> Keep in mind that the location of server region, cpu options and additional storage can be configured up to own preference
3. Before connecting to the VPS, allow the newly created SSH key to be identified by inputting the following command on terminal
	```
	ssh -i sop_as1 user@157.245.52.255
	```
	> Make sure when the command is in the same directory as the location of the SSH key
	
### 3. Setup new user
1. `adduser ftt1241`
2. Enable sudo privilege to new user
	```
	usermod -aG sudo ftt1241
	```
3. Enable external access for regular user by copying the authorized_keys on `~/.ssh/authorized_keys` root to targeted users direcotry 
	```
	rsync --archive --chown=ftt1241:ftt1241 ~/.ssh /home/ftt1241
	```

  
### 4. Server Setup
1. Edit config file inside the following directory `sudo nano \etc\ssh\sshd_config`, once inside do the following:
	1. Change the port to custom port, in this case it is `Port 1241`
	> **Important Notes**
	>> Allow the new port number  to the firewall before proceeding to avoid issue `sudo ufw allow 1241/tcp`
	2. Change the root login to `PermitRootLogin no`
	3. Limit maximum authentication attempts to `MaxAuthTries 3`
	4. Enable public athentication `PubkeyAuthentication yes`
	5. 


- Only allow pub key auth, not pass auth to VPS
- Don’t allow root to login, only allow non-root user with sudo priv to login
- Have max auth tries of 3 attempts (Done)
- Uses any other non-default port other than 22 and starts above 1024 (Done)
  - sudo nano /etc/ssh/sshd_config
  - Uncomment the #Port 22 and change to desired port num
    - sudo ufw allow 1241/tcp - Allow the new port number to the firewall
  - Change MaxAuthTries 3
  - PubkeyAuthentication yes
  - PasswordAuthentication no
  - PermitRootLogin no

SSH Client setup

- The PC workstation must set up a shortcut; via config to connect to VPS.
  - Example: instead of “ssh user@244.244.244.244”, it should be just “ssh as1”
  - Create config file in windows and insert the following


|<p>Host as1</p><p>`    `HostName 157.245.52.255</p><p>`    `User ftt1241</p><p>`    `Port 1241</p><p>`    `IdentityFile ~/.ssh/sop\_as1</p>|
| :- |


VPS

- VPS hostname: sop-as1
- Have a web server running nginx
- Firewall to only enable web traffic (port 80 & 443) and SSH traffic - must be minimal, no dupe
- Has a time zone of +8 GMT
  - sudo timedatectl set-timezone Asia/Singapore

Web Server

- Shows a welcome page
